#
#       $Id: Smakefile,v 4.2 1996/03/26 08:19:39 jraja Exp $
#
#       Smakefile for msg
#
#       Copyright © 1994 AmiTCP/IP Group, 
#                        Network Solutions Development Inc.
#                        All rights reserved.
#

MAKE = smake
RM= delete
CC= sc
RPCCOM = rpcgen
LD= slink

#
# Note that we have selected the register argument version of the rpc
# library and the SCOPTIONS file has PARAMETERS option set to REGISTER.
# Use the USE_DOSIO versions of the libraries.
#
LIBS= LIB NETLIB:rpcdr.lib NETLIB:netd.lib

CFLAGS= DEF=USE_DOSIO

BIN = printmsg msg_svc rprintmsg
GEN = msg_clnt.c msg_svc.c msg_xdr.c msg.h

all: $(BIN)

#
# This is the non-networked version of the program
#
printmsg: printmsg.o
	$(CC) LINK TO $@ OBJ printmsg.o $(LIBS)

#
# note: the generated xdr file is virtually empty.
#
$(GEN): msg.x
	$(RPCCOM) msg.x

msg_svc: msg_proc.o msg_svc.o
	$(CC) LINK TO $@ OBJ msg_proc.o msg_svc.o $(LIBS)

rprintmsg: rprintmsg.o msg_clnt.o
	$(CC) LINK TO $@ OBJ rprintmsg.o msg_clnt.o $(LIBS)

rprintmsg.o: rprintmsg.c msg.h

msg_proc.o: msg_proc.c msg.h

clean cleanup:
	-$(RM) \#?.(o|asm|map|lnk) $(GEN) $(BIN) \#?!
